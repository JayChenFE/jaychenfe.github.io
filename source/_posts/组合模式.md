---
title: 组合模式
date: 2019-05-17 22:50:53
categories: [设计模式]
tags:
top:
---

[TOC]

# 原理

# 示例

## 组装电脑(python实现)

只要你对硬件稍微有一些了解，或者打开过机箱换过组件，一定知道 CPU、内存、显卡是插在主板上的，而硬盘也是连在主板上的，在机箱的后面有一排的插口，可以连接鼠标、键盘、耳麦、摄像头等外接配件，而显示器需要单独插电源才能工作。我们可以用代码来模拟台式电脑的组成，这里假设每一个组件都有开始工作和结束工作两个功能，还可以显示自己的信息和组成结构。

代码如下:

```python
class Component:
    "组件，所有子配件的基类"

    def __init__(self, name):
        self._name = name

    def showInfo(self, indent=""):
        pass

    def isComposite(self):
        return False

    def startup(self, indent=""):
        print(indent + self._name + " 准备开始工作...")

    def shutdown(self, indent=""):
        print(indent + self._name + " 即将结束工作...")


class CPU(Component):
    "中央处理器"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent, end="")
        print("CPU:" + self._name + ",可以进行高速计算。")


class MemoryCard(Component):
    "内存条"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent, end="")
        print("内存:" + self._name + ",可以缓存数据，读写速度快。")


class HardDisk(Component):
    "硬盘"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent, end="")
        print("硬盘:" + self._name + ",可以永久存储数据，容量大。")


class GraphicsCard(Component):
    "显卡"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent, end="")
        print("显卡:" + self._name + ",可以高速计算和处理图形图像。")


class Battery(Component):
    "电源"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent, end="")
        print("电源:" + self._name + ",可以持续给主板和外接配件供电。")


class Fan(Component):
    "风扇"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent, end="")
        print("风扇:" + self._name + "，辅助CPU散热。")


class Displayer(Component):
    "显示器"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent, end="")
        print("显示器:" + self._name + "，负责内容的显示。")


class Composite(Component):
    "配件组合器"

    def __init__(self, name):
        super().__init__(name)
        self._components = []

    def showInfo(self, indent):
        print(self._name + ",由以下部件组成:")
        indent += "\t"
        for element in self._components:
            element.showInfo(indent)

    def isComposite(self):
        return True

    def addComponent(self, component):
        self._components.append(component)

    def removeComponent(self, component):
        self._components.remove(component)

    def startup(self, indent):
        super().startup(indent)
        indent += "\t"
        for element in self._components:
            element.startup(indent)

    def shutdown(self, indent):
        super().startup(indent)
        indent += "\t"
        for element in self._components:
            element.shutdown(indent)


class Mainboard(Composite):
    "主板"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent + "主板:", end="")
        super().showInfo(indent)


class ComputerCase(Composite):
    "机箱"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent + "机箱:", end="")
        super().showInfo(indent)


class Computer(Composite):
    "电脑"

    def __init__(self, name):
        super().__init__(name)

    def showInfo(self, indent):
        print(indent + "电脑:", end="")
        super().showInfo(indent)

```
测试代码:
```python
def testComputer():
    cpu = CPU("Intel Core i5-6600K")
    memoryCard = MemoryCard("Kingston Fury DDR4")
    hardDisk = HardDisk("Kingston V300 ")
    graphicsCard = GraphicsCard("Colorful iGame750")
    mainBoard = Mainboard("GIGABYTE Z170M M-ATX")
    mainBoard.addComponent(cpu)
    mainBoard.addComponent(memoryCard)
    mainBoard.addComponent(hardDisk)
    mainBoard.addComponent(graphicsCard)

    battery = Battery("Antec VP 450P")
    fan = Fan("DEEPCOOL 120T")
    computerCase = ComputerCase("SAMA MATX")
    computerCase.addComponent(battery)
    computerCase.addComponent(mainBoard)
    computerCase.addComponent(fan)

    displayer = Displayer("AOC LV243XIP")

    computer = Computer("Tony DIY电脑")
    computer.addComponent(displayer)
    computer.addComponent(computerCase)

    computer.showInfo("")
    print("\n开机过程:")
    computer.startup("")
    print("\n关机过程:")
    computer.shutdown("")
    
testComputer()
```

输出结果：

```python
电脑:Tony DIY电脑,由以下部件组成:
    显示器:AOC LV243XIP，负责内容的显示。
    机箱:SAMA MATX,由以下部件组成:
        电源:Antec VP 450P,可以持续给主板和外接配件供电。
        主板:GIGABYTE Z170M M-ATX,由以下部件组成:
            CPU:Intel Core i5-6600K,可以进行高速计算。
            内存:Kingston Fury DDR4,可以缓存数据，读写速度快。
            硬盘:Kingston V300 ,可以永久存储数据，容量大。
            显卡:Colorful iGame750,可以高速计算和处理图形图像。
        风扇:DEEPCOOL 120T，辅助CPU散热。

开机过程:
Tony DIY电脑 准备开始工作...
    AOC LV243XIP 准备开始工作...
    SAMA MATX 准备开始工作...
        Antec VP 450P 准备开始工作...
        GIGABYTE Z170M M-ATX 准备开始工作...
            Intel Core i5-6600K 准备开始工作...
            Kingston Fury DDR4 准备开始工作...
            Kingston V300  准备开始工作...
            Colorful iGame750 准备开始工作...
        DEEPCOOL 120T 准备开始工作...

关机过程:
Tony DIY电脑 准备开始工作...
    AOC LV243XIP 即将结束工作...
    SAMA MATX 准备开始工作...
        Antec VP 450P 即将结束工作...
        GIGABYTE Z170M M-ATX 准备开始工作...
            Intel Core i5-6600K 即将结束工作...
            Kingston Fury DDR4 即将结束工作...
            Kingston V300  即将结束工作...
            Colorful iGame750 即将结束工作...
        DEEPCOOL 120T 即将结束工作...
```

